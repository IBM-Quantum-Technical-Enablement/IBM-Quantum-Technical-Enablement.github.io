

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Dynamic circuits - III &#8212; Enabing Technologies  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/thebelab-helper.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-16824831-8"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-16824831-8');
            </script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'events/skku-2022/dynamic-circuits-3';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>

<link
  rel="alternate"
  type="application/atom+xml"
  href="../../explore/atom.xml"
  title="Quantum Explorations"
/>



  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the site..."
         aria-label="Search the site..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/dark_logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../how-to/howto.html">
                        How to guides
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../explore.html">
                        Explorations
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../hardware/hardware.html">
                        IBM Hardware
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../events.html">
                        Events
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../members.html">
                        Contributors
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the site..."
         aria-label="Search the site..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/IBM-Quantum-Technical-Enablement" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../how-to/howto.html">
                        How to guides
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../explore.html">
                        Explorations
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../hardware/hardware.html">
                        IBM Hardware
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../events.html">
                        Events
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../members.html">
                        Contributors
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the site..."
         aria-label="Search the site..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/IBM-Quantum-Technical-Enablement" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Dynamic circuits - III</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
<p><img alt="beta" src="../../_images/beta-version6.jpg" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="dynamic-circuits-iii">
<h1>Dynamic circuits - III<a class="headerlink" href="#dynamic-circuits-iii" title="Permalink to this heading">#</a></h1>
<div class="alert alert-warning">
    This notebook is requires installing the <tt>qiskit-ibm-provider</tt>:
    <ul>
        <li>IBM Qiskit Provider: <tt>pip install qiskit-ibm-provider</tt></li>
    </ul>
</div><section id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this heading">#</a></h2>
<p>Having stuck with the BV circuit for some time now, let us branch out to other uses of dynamic circuits.  There is a wide variety of examples that are impossible to implement without dynamic circuits.  One of the most cited examples is that of quantum teleportation, where entanglement between qubits and classical communication is used to move the state of one qubit to another.  Another prominent use case area for dynamic circuits is quantum error correction (QEC).  Here we will examine examples of both.</p>
</section>
<section id="front-matter">
<h2>Front matter<a class="headerlink" href="#front-matter" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># We will use random 1Q gates for teleportation</span>
<span class="kn">from</span> <span class="nn">qiskit.quantum_info</span> <span class="kn">import</span> <span class="n">random_unitary</span>
<span class="c1"># We will have to look at marginal counts (subsets over a few bits)</span>
<span class="kn">from</span> <span class="nn">qiskit.result</span> <span class="kn">import</span> <span class="n">marginal_counts</span>

<span class="c1"># Aer simulator</span>
<span class="kn">from</span> <span class="nn">qiskit_aer</span> <span class="kn">import</span> <span class="n">AerSimulator</span>

<span class="c1"># Load a fake device</span>
<span class="kn">from</span> <span class="nn">qiskit.providers.fake_provider</span> <span class="kn">import</span> <span class="n">FakeHanoi</span>


<span class="c1"># Load the QASM3 exporter</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">qasm3</span>


<span class="c1"># Plotting tools</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;quantum-light&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39;
</pre></div>
</div>
</div>
</div>
<section id="load-ibm-provider-and-select-target-backend">
<h3>Load IBM provider and select target backend<a class="headerlink" href="#load-ibm-provider-and-select-target-backend" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit_ibm_provider</span> <span class="kn">import</span> <span class="n">IBMProvider</span>

<span class="n">provider</span> <span class="o">=</span> <span class="n">IBMProvider</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">backend</span> <span class="o">=</span> <span class="n">provider</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;ibm_peekskill&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="quantum-teleportation">
<h2>Quantum teleportation<a class="headerlink" href="#quantum-teleportation" title="Permalink to this heading">#</a></h2>
<p>Quantum teleportation is an example of utilizing quantum entanglement and classical resources to transfer quantum information from a sender to a receiver.  That we transfer the information, as oppose to copying it, is a requirement of the <a class="reference external" href="https://en.wikipedia.org/wiki/No-cloning_theorem">No-cloning theorem</a>, which forbids one from copy an unknown quantum state.</p>
<p>Suppose we want to teleport the state for qubit C <span class="math notranslate nohighlight">\(|\psi\rangle_{\rm C}= \alpha|0\rangle_{\rm C} +\beta|1\rangle_{\rm C}\)</span> that is shared with qubit A (Alice) over to qubit B (Bob).  First we create a Bell pair (entanglement resource) between A and B, such that the state of the complete system is (in Qiskit bit-ordering):</p>
<div class="math notranslate nohighlight">
\[
|\Psi\rangle_{\rm BAC} = \frac{1}{\sqrt{2}}\left[ |00\rangle_{\rm BA} + |11\rangle_{\rm BA}\right]\otimes \left[\alpha|0\rangle_{\rm C}+\beta |1\rangle_{\rm C}\right]
\]</div>
<p>Now to proceed, we will make use of the Bell basis (In Qiskit bit-ordering):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
|B_{0}\rangle = \mathbb{I}\otimes \mathbb{I}|B_{0}\rangle = \frac{1}{\sqrt{2}}\left[|00\rangle+|11\rangle\right] \\
|B_{1}\rangle = Z\otimes \mathbb{I}|B_{0}\rangle = \frac{1}{\sqrt{2}}\left[|00\rangle-|11\rangle\right]\\
|B_{2}\rangle = X\otimes \mathbb{I}|B_{0}\rangle = \frac{1}{\sqrt{2}}\left[|01\rangle+|10\rangle\right]\\
|B_{3}\rangle = ZX\otimes \mathbb{I}|B_{0}\rangle = \frac{1}{\sqrt{2}}\left[|01\rangle-|10\rangle\right]\\
\end{split}\]</div>
<p>Thus, in circuit notation, each Bell state can be formed via:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bell_basis</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>

    <span class="n">bell</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">bell</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">bell</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">bell</span><span class="o">.</span><span class="n">z</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">bell</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">bell</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">bell</span><span class="o">.</span><span class="n">z</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Index must be in [0,1,2,3]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bell</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">display</span><span class="p">(</span><span class="n">bell_basis</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e6ab0f7eada7937c0ac9dcbdcf60a7c6d68c60ee498d2c54a94542d01fe08667.png" src="../../_images/e6ab0f7eada7937c0ac9dcbdcf60a7c6d68c60ee498d2c54a94542d01fe08667.png" />
<img alt="../../_images/14bddca4f71cfe4b55246fc6137f1b721b2a4bf5b534cfb5a8194f0f6517fd8f.png" src="../../_images/14bddca4f71cfe4b55246fc6137f1b721b2a4bf5b534cfb5a8194f0f6517fd8f.png" />
<img alt="../../_images/e2bbf39032faea06f86f9ae94aab4441a5a92cf1b07fb4aaa480427eb91c06a2.png" src="../../_images/e2bbf39032faea06f86f9ae94aab4441a5a92cf1b07fb4aaa480427eb91c06a2.png" />
<img alt="../../_images/cb49e50ff56658a894a04c6b3d304a2a33a2df2f87708dc1ea571f0eb4921e43.png" src="../../_images/cb49e50ff56658a894a04c6b3d304a2a33a2df2f87708dc1ea571f0eb4921e43.png" />
</div>
</div>
<p>If we do a basis change and express the combined state of qubits A &amp; C in terms of the Bell states, then the full tripartite system can be written as (ignoring overall factor of 1/2):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
|\Psi\rangle_{\rm BAC} =&amp; |\psi\rangle_{B}\otimes|B_{0}\rangle_{(AC)}+ \\
&amp;Z|\psi\rangle_{B}\otimes|B_{1}\rangle_{(AC)} + \\
&amp;X|\psi\rangle_{B}\otimes |B_{2}\rangle_{(AC)} + \\
&amp;ZX|\psi\rangle_{B}\otimes |B_{3}\rangle_{(AC)}
\end{align}
\end{split}\]</div>
<p>That is to say that, if we measure the state of AC to be in the i-th Bell state, then qubit B is in the desired state modulo the same gates needed to construct the i-th Bell state.  If we know, i.e. measure, AC to be in the i-th Bell state, then we know which gates we need to apply to fix this.  We therefore need to figure out how to measure Bell states.  It is important to note that <strong>we have not done anything but express A and C in a different basis and rearrange terms</strong>.</p>
<p>In order to pick out the particular Bell state via measurements, we need to perform a Bell measurement on pair AC.  The circuit for this is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bell_meas</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">bell_meas</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">bell_meas</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">bell_meas</span><span class="o">.</span><span class="n">measure_all</span><span class="p">()</span>
<span class="n">bell_meas</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f136950e1d1a2185a1678b494415cca19951bceccd720a9be58c1f1b2bf6278e.png" src="../../_images/f136950e1d1a2185a1678b494415cca19951bceccd720a9be58c1f1b2bf6278e.png" />
</div>
</div>
<p>In particular, it can be shown that a Bell measurement on the state <span class="math notranslate nohighlight">\(|B_{i}\rangle\)</span> yields the binary representation of the integer <span class="math notranslate nohighlight">\(i\)</span>, e.g. <span class="math notranslate nohighlight">\(i=2\)</span> yields the bit-string <code class="docutils literal notranslate"><span class="pre">10</span></code>.  Whats more is that the resulting bit-string tells us which gate(s) we need to correct for.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bell measurement of B(</span><span class="si">{}</span><span class="s2">):&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
          <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">bell_basis</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">bell_meas</span><span class="p">),</span>
                  <span class="n">shots</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bell measurement of B(0): {&#39;00&#39;: 100}
Bell measurement of B(1): {&#39;01&#39;: 100}
Bell measurement of B(2): {&#39;10&#39;: 100}
Bell measurement of B(3): {&#39;11&#39;: 100}
</pre></div>
</div>
</div>
</div>
<p>Here we make a circuit that generates a random initial state for qubit C, and teleports it to qubit B via the above method.  To verify that the state was generated, here we apply the inverse of the unitary used to generate the state, and look to see if we get back to the ground state.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a random state for qubit C</span>
<span class="n">random_1q_gate</span> <span class="o">=</span> <span class="n">random_unitary</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to_instruction</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a random state for qubit C</span>
<span class="n">random_1q_gate</span> <span class="o">=</span> <span class="n">random_unitary</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to_instruction</span><span class="p">()</span>

<span class="c1"># Create a register for each qubit of interest</span>
<span class="n">qrA</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;qA&#39;</span><span class="p">)</span>
<span class="n">qrB</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;qB&#39;</span><span class="p">)</span>
<span class="n">qrC</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;qC&#39;</span><span class="p">)</span>

<span class="c1"># Create a single classical register</span>
<span class="n">cr</span> <span class="o">=</span> <span class="n">ClassicalRegister</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Create circuit</span>
<span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">qrC</span><span class="p">,</span> <span class="n">qrA</span><span class="p">,</span> <span class="n">qrB</span><span class="p">,</span> <span class="n">cr</span><span class="p">)</span>
<span class="c1"># Make C qubit in random quantum state</span>
<span class="n">qc</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">random_1q_gate</span><span class="p">,</span> <span class="n">qrC</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Form Bell pair between A and B</span>
<span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">qrA</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">qrA</span><span class="p">,</span> <span class="n">qrB</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">barrier</span><span class="p">()</span>

<span class="c1"># Bell measurement</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">qrC</span><span class="p">,</span> <span class="n">qrA</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">qrC</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">measure</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">qc</span><span class="o">.</span><span class="n">barrier</span><span class="p">()</span>
<span class="c1"># Corrective Pauli gates</span>
<span class="c1"># If returned bit-string is 01 = 1</span>
<span class="n">qc</span><span class="o">.</span><span class="n">z</span><span class="p">(</span><span class="n">qrB</span><span class="p">)</span><span class="o">.</span><span class="n">c_if</span><span class="p">(</span><span class="n">cr</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># If returned bit-string is 10 = 2</span>
<span class="n">qc</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">qrB</span><span class="p">)</span><span class="o">.</span><span class="n">c_if</span><span class="p">(</span><span class="n">cr</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1"># If returned bit-string is 11 = 3</span>
<span class="n">qc</span><span class="o">.</span><span class="n">z</span><span class="p">(</span><span class="n">qrB</span><span class="p">)</span><span class="o">.</span><span class="n">c_if</span><span class="p">(</span><span class="n">cr</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">qrB</span><span class="p">)</span><span class="o">.</span><span class="n">c_if</span><span class="p">(</span><span class="n">cr</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">qc</span><span class="o">.</span><span class="n">barrier</span><span class="p">()</span>
<span class="c1"># Apply inverse of unitary that generated state C</span>
<span class="n">qc</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">random_1q_gate</span><span class="o">.</span><span class="n">inverse</span><span class="p">(),</span> <span class="n">qrB</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Measure the Z component of B (overwriting the previous result)</span>
<span class="c1"># We should be back in the ground state</span>
<span class="n">qc</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">qrB</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e8675b2edcff651dc32687e6a41916f42e1875d0a80169b7b0af591a7c3ef1e5.png" src="../../_images/e8675b2edcff651dc32687e6a41916f42e1875d0a80169b7b0af591a7c3ef1e5.png" />
</div>
</div>
<section id="simulate-the-results">
<h3>Simulate the results<a class="headerlink" href="#simulate-the-results" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim_counts</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We only care about the zeroth bit here so need to marginalize here, returning only what we want</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">marg_sim_counts</span> <span class="o">=</span> <span class="n">marginal_counts</span><span class="p">(</span><span class="n">sim_counts</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">marg_sim_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;0&#39;: 10000}
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-on-hardware">
<h3>Run on hardware<a class="headerlink" href="#run-on-hardware" title="Permalink to this heading">#</a></h3>
<p>Now we are in a position to run on hardware.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trans_qc</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">initial_layout</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Lets take the opportunity to see what a transpiled QASM3 circuit looks like:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">qasm3</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">trans_qc</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>OPENQASM 3;
include &quot;stdgates.inc&quot;;
bit[2] c0;
rz(-0.52767) $0;
sx $0;
rz(-0.77932) $0;
sx $0;
rz(1.9861) $0;
rz(pi/2) $1;
sx $1;
rz(pi/2) $1;
cx $1, $4;
barrier $0, $1, $4;
cx $0, $1;
rz(pi/2) $0;
sx $0;
rz(pi/2) $0;
c0[0] = measure $0;
c0[1] = measure $1;
barrier $0, $1, $4;
if (c0 == 1) {
  rz(pi) $4;
}
if (c0 == 2) {
  x $4;
}
if (c0 == 3) {
  rz(pi) $4;
}
if (c0 == 3) {
  x $4;
}
barrier $0, $1, $4;
rz(-1.9861) $4;
sx $4;
rz(-0.77932) $4;
sx $4;
rz(0.52767) $4;
c0[0] = measure $4;
</pre></div>
</div>
</div>
</div>
<p>Now lets run the compiled circuit, remembering we need to set <code class="docutils literal notranslate"><span class="pre">dynamic=True</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">job1</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">trans_qc</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">dynamic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Marginalize counts and see if we are close to the above:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">real_counts</span> <span class="o">=</span> <span class="n">job1</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>
<span class="n">marg_real_counts</span> <span class="o">=</span> <span class="n">marginal_counts</span><span class="p">(</span><span class="n">real_counts</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">marg_real_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;0&#39;: 7876, &#39;1&#39;: 2124}
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="bit-flip-code">
<h2>Bit-flip code<a class="headerlink" href="#bit-flip-code" title="Permalink to this heading">#</a></h2>
<p>The bit-flip code is one of the simplest examples of a stabilizer code.  It is capable of protecting the encoded version of our state from single bit-flip (x-gate) errors. Here we will do a simple demonstration of this, correcting for a single-round of errors.</p>
<p>Let the initial state be <span class="math notranslate nohighlight">\(|\psi\rangle = \alpha|0\rangle +\beta|1\rangle\)</span>.  The encoding needed for the bit-flip code mirrors this state onto the 3-qubit state</p>
<div class="math notranslate nohighlight">
\[
|\psi\rangle_{\rm rep} = \alpha|000\rangle +\beta|111\rangle
\]</div>
<p>We cannot measure the qubits in the state directly, or we would destroy the state.  Therefore, we will need additional ancilla qubits on which to write the parity of the qubits.  Moreover, measuring individual qubits does not give enough knowledge to determine on which qubit an error occurred.  Rather, we need to measure the parity of <em>pairs</em> of qubits to determine which qubit has been flipped.</p>
<p>Here we will look at joint parity measurements of qubits <span class="math notranslate nohighlight">\(Q0\oplus Q1\)</span>, as well as <span class="math notranslate nohighlight">\(Q1 \oplus Q2\)</span>, stored as classical bits 0 and 1, respectively.  So see how this works, let us look at what the measurement yields for each possible case of a single bit-flip.</p>
<ul class="simple">
<li><p>Error on Q0:
$<span class="math notranslate nohighlight">\(
   \alpha|001\rangle+\beta|110\rangle\ \ \rightarrow \ \ 01
   \)</span>$</p></li>
<li><p>Error on Q1:
$<span class="math notranslate nohighlight">\(
   \alpha|010\rangle+\beta|101\rangle\ \ \rightarrow \ \ 11
   \)</span>$</p></li>
<li><p>Error on Q2:
$<span class="math notranslate nohighlight">\(
   \alpha|100\rangle+\beta|011\rangle\ \ \rightarrow \ \ 10
   \)</span>$</p></li>
</ul>
<p>We see that the joint parity measurement information allows us to identify which of the three qubits had a error.  We can then use this measurement information to conditionally flip the erroneous bit.</p>
<p>Here we start with an arbitrary 1Q state, encode it into the bit-flip code and correct any single-flips that might have occurred.  To check the validity of the correction, we attempt to undo the encoding and arbitrary state, and measure how close we return to the ground state.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate random 1Q gate</span>
<span class="n">random_1q_gate</span> <span class="o">=</span> <span class="n">random_unitary</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to_instruction</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a register for each qubit of interest</span>
<span class="n">qr1</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;state&#39;</span><span class="p">)</span>
<span class="n">qr2</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;ancilla&#39;</span><span class="p">)</span>
<span class="n">cr</span> <span class="o">=</span> <span class="n">ClassicalRegister</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>

<span class="n">qc2</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">qr1</span><span class="p">,</span> <span class="n">qr2</span><span class="p">,</span> <span class="n">cr</span><span class="p">)</span>

<span class="c1"># Encode state</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">random_1q_gate</span><span class="p">,</span> <span class="p">[</span><span class="n">qr1</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">qr1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qr1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">qr1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qr1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="n">qc2</span><span class="o">.</span><span class="n">barrier</span><span class="p">()</span>
<span class="c1"># Joint party of 0 and 1 onto ancilla 0</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">qr1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qr2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">qr1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">qr2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Joint party of 1 and 2 onto ancilla 1</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">qr1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">qr2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">qr1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">qr2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">qc2</span><span class="o">.</span><span class="n">barrier</span><span class="p">()</span>
<span class="c1"># Perform the syndrome measurement</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">qr2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">qr2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Conditionally flip bits</span>
<span class="c1"># We need to use the old c_if syntax in order to do noisy simulations</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">qr1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">c_if</span><span class="p">(</span><span class="n">cr</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">qr1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">c_if</span><span class="p">(</span><span class="n">cr</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">qr1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">c_if</span><span class="p">(</span><span class="n">cr</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="n">qc2</span><span class="o">.</span><span class="n">barrier</span><span class="p">()</span>
<span class="c1"># Undo computation and measure if back in ground state</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">qr1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qr1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">qr1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qr1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">random_1q_gate</span><span class="o">.</span><span class="n">inverse</span><span class="p">(),</span> <span class="p">[</span><span class="n">qr1</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Record the probability of being back in the ground state</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7a465c0a0a1e7be7208e5d2457e9832f09930c3da5f4f133aa2ac7e1f39cb090.png" src="../../_images/7a465c0a0a1e7be7208e5d2457e9832f09930c3da5f4f133aa2ac7e1f39cb090.png" />
</div>
</div>
<section id="simulation">
<h3>Simulation<a class="headerlink" href="#simulation" title="Permalink to this heading">#</a></h3>
<p>Because we are correcting noisy behavior, we will need a noisy simulator to inject bit-flip errors.  There is no Peekskill noisy simulator, and we currently cannot build one from the new provider backends, so we will use another system here:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">FakeHanoi</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We have two different pieces of information in our counts.  First, the ancilla bits contain the information on what errors, and how many occurred.  The second bit records how often our system should be in the ground state.  Ideally this is 100% of the time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim_counts2</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">qc2</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>
<span class="n">anc_counts</span> <span class="o">=</span> <span class="n">marginal_counts</span><span class="p">(</span><span class="n">sim_counts2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ans_counts</span> <span class="o">=</span> <span class="n">marginal_counts</span><span class="p">(</span><span class="n">sim_counts2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Errors detected:&#39;</span><span class="p">,</span> <span class="n">anc_counts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Errors detected: {&#39;01&#39;: 112, &#39;10&#39;: 79, &#39;00&#39;: 9767, &#39;11&#39;: 42}
</pre></div>
</div>
</div>
</div>
<p>We see that errors occur a couple hundred of time, but the vast majority of time there are no qubit errors.  Taken together with the fact that we are correcting errors, the final qubit should be found in the ground state with high-probability.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ans_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;1&#39;: 197, &#39;0&#39;: 9803}
</pre></div>
</div>
</div>
</div>
</section>
<section id="hardware-execution">
<h3>Hardware execution<a class="headerlink" href="#hardware-execution" title="Permalink to this heading">#</a></h3>
<p>We can now transpile the circuit and execute on hardware.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Transpile circuit with good transpiler seed</span>
<span class="n">trans_qc2</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">qc2</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">seed_transpiler</span><span class="o">=</span><span class="mi">1514439656</span><span class="p">)</span>
<span class="n">trans_qc2</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">,</span> <span class="n">idle_wires</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6c79493271378edaf268ba148ee589629a1383ef224b277e90b87dd81cac494c.png" src="../../_images/6c79493271378edaf268ba148ee589629a1383ef224b277e90b87dd81cac494c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">real_counts2</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">trans_qc2</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">dynamic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">real_anc_counts</span> <span class="o">=</span> <span class="n">marginal_counts</span><span class="p">(</span><span class="n">real_counts2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">real_ans_counts</span> <span class="o">=</span> <span class="n">marginal_counts</span><span class="p">(</span><span class="n">real_counts2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Errors detected:&#39;</span><span class="p">,</span> <span class="n">real_anc_counts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Errors detected: {&#39;00&#39;: 9298, &#39;01&#39;: 200, &#39;10&#39;: 362, &#39;11&#39;: 140}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">real_ans_counts</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;0&#39;: 5194, &#39;1&#39;: 4806}
</pre></div>
</div>
</div>
</div>
<p>Obviously this final result is far from what we want.  This is because there are many sources of error beyond simple bit-flips that need to be taken into account.</p>
</section>
</section>
</section>

<div class="section ablog__blog_comments">
  
  
</div>

                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#front-matter">Front matter</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-ibm-provider-and-select-target-backend">Load IBM provider and select target backend</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-teleportation">Quantum teleportation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simulate-the-results">Simulate the results</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-on-hardware">Run on hardware</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bit-flip-code">Bit-flip code</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simulation">Simulation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hardware-execution">Hardware execution</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../../_sources/events/skku-2022/dynamic-circuits-3.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

<footer class="bd-footer">
<div>
<p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/">
        Content on
        <a property="dct:title" rel="cc:attributionURL" href="http://quantum-enablement.org">this website</a> 
        by <span property="cc:attributionName">IBM</span> is licensed under 
        <a href="http://creativecommons.org/licenses/by-nc/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">
                Attribution-NonCommercial 4.0 International<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1">
                <img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1">
                <img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1">
        </a>
</p> 
</div>
</footer>

  </body>
</html>