

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Circuit timing information &#8212; Enabing Technologies  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/thebelab-helper.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-16824831-8"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-16824831-8');
            </script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'how-to/timing/circuit-timing';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Dynamical decoupling" href="dynamical-decoupling.html" />
    <link rel="prev" title="Using the Qiskit compiler" href="../compiling/compiling.html" />

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>

<link
  rel="alternate"
  type="application/atom+xml"
  href="../../explore/atom.xml"
  title="Quantum Explorations"
/>



  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the site..."
         aria-label="Search the site..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/dark_logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../howto.html">
                        How to guides
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../explore.html">
                        Explorations
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../hardware/hardware.html">
                        IBM Hardware
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../events.html">
                        Events
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../members.html">
                        Contributors
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the site..."
         aria-label="Search the site..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/IBM-Quantum-Technical-Enablement" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../howto.html">
                        How to guides
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../explore.html">
                        Explorations
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../hardware/hardware.html">
                        IBM Hardware
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../events.html">
                        Events
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../members.html">
                        Contributors
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the site..."
         aria-label="Search the site..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/IBM-Quantum-Technical-Enablement" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Quick start</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../quick/quick-start.html">Quick start guide</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Circuit compilation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../compiling/compiling.html">Using the Qiskit compiler</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Circuit timing</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Circuit timing information</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamical-decoupling.html">Dynamical decoupling</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Error mitigation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../mitigation/M3/m3_mitigation.html">Mesurement error mitigation using M3</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Visualization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../visualization/matplotlib.html">Matplotlib styles</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../howto.html" class="nav-link">How to guides</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Circuit timing information</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
<section class="tex2jax_ignore mathjax_ignore" id="circuit-timing-information">
<h1>Circuit timing information<a class="headerlink" href="#circuit-timing-information" title="Permalink to this heading">#</a></h1>
<section id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this heading">#</a></h2>
<p>Quantum circuits are abstract objects; circuits are comprised of a set of virtual qubits onto which one applies instructions.  Even after compilation targeting a specific quantum system, there is no explicit notion of “how long” does a circuit run for.  One can use the circuit depth as a proxy for detialed timing information, but it is useful for comparisons only.</p>
<p>Executing circuits on hardware takes time, and there are a variety of reasons as to why this timing information is worth knowing.  First and foremost, the execution time of one or more circuits is the primary metric by which the “cost” of a quantum computation is determined.  Second, it can give insight into how noise affects the circuit; if the circuit duration is an appreciable fraction of <span class="math notranslate nohighlight">\(T_{1}\)</span> or <span class="math notranslate nohighlight">\(T_{2}\)</span>, then the resultant output is likely to be noisy.  Moreover, the error rates of many instructions, eg. measurements, is primarily determined by the duration of time that those operations last.  In addition, knowing the timing of circuit operations, including the amount of time that qubits are idle, allows for suppressing several sources of errors via the application of dynamical decoupling (DD).  Lastly, working at the level of physical pulses, rather than abstract gates, necessarily requires timing knowledge.  Here we will see how to look at timing information in a circuit and how that affects noise modelling on simulators.  Finally we will throw it all together in an example.</p>
</section>
<section id="frontmatter">
<h2>Frontmatter<a class="headerlink" href="#frontmatter" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">qiskit.circuit</span> <span class="kn">import</span> <span class="n">Parameter</span>
<span class="kn">from</span> <span class="nn">qiskit.quantum_info</span> <span class="kn">import</span> <span class="n">hellinger_fidelity</span>

<span class="c1"># Grab the statevector class</span>
<span class="kn">from</span> <span class="nn">qiskit.quantum_info</span> <span class="kn">import</span> <span class="n">Statevector</span>
<span class="c1">#Routine for computing expectation values from sampled values</span>
<span class="kn">from</span> <span class="nn">qiskit.result</span> <span class="kn">import</span> <span class="n">sampled_expectation_value</span>

<span class="c1"># Visualize circuit timing information</span>
<span class="kn">from</span> <span class="nn">qiskit.visualization</span> <span class="kn">import</span> <span class="n">timeline_drawer</span>

<span class="c1"># Import Aer simulator</span>
<span class="kn">from</span> <span class="nn">qiskit_aer</span> <span class="kn">import</span> <span class="n">AerSimulator</span>

<span class="c1"># Plotting tools</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;quantum-light&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="circuit-timing">
<h2>Circuit timing<a class="headerlink" href="#circuit-timing" title="Permalink to this heading">#</a></h2>
<p>Suppose that I have the following two circuits that make 5-qubit GHZ states:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc1</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">qc1</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">qc1</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">qc1</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc1</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">qc1</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">qc1</span><span class="o">.</span><span class="n">measure_all</span><span class="p">()</span>
<span class="n">qc1</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/cd0e4aa9149add8a2e5f2010c26390a1b11cc173e08ebbcb341173bd07ed5528.png" src="../../_images/cd0e4aa9149add8a2e5f2010c26390a1b11cc173e08ebbcb341173bd07ed5528.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc2</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">measure_all</span><span class="p">()</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/87d16d626cf191795631fb782ba8bca4d84043859491047114ac88df6be80277.png" src="../../_images/87d16d626cf191795631fb782ba8bca4d84043859491047114ac88df6be80277.png" />
</div>
</div>
<p>How long does it take each circuit to execute on hardware?  The answer is of course: “It depends”.  The answer is determined by which quantum system is selected, which qubits in that system are used for the computation, and even which qubit routing strategy is employed.  Lets begin by choosing a system and seeing what timing information can be gathered.</p>
</section>
<section id="backend-timing-information">
<h2>Backend timing information<a class="headerlink" href="#backend-timing-information" title="Permalink to this heading">#</a></h2>
<p>Each IBM Quantum backend (and most “fake” backends) have all their timing information stored in their <code class="docutils literal notranslate"><span class="pre">properties</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.providers.fake_provider</span> <span class="kn">import</span> <span class="n">FakeKolkata</span>
<span class="n">backend</span> <span class="o">=</span> <span class="n">FakeKolkata</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">props</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We know that the only gates a device supports are found in the <code class="docutils literal notranslate"><span class="pre">basis_gates</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">basis_gates</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">configuration</span><span class="p">()</span><span class="o">.</span><span class="n">basis_gates</span>
<span class="n">basis_gates</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;id&#39;, &#39;rz&#39;, &#39;sx&#39;, &#39;x&#39;, &#39;cx&#39;, &#39;reset&#39;]
</pre></div>
</div>
</div>
</div>
<p>Thus we expect to be able to find timing information for each of these gates.  Lets see how long all the 1Q gates take on qubit 0.  This can be done using <code class="docutils literal notranslate"><span class="pre">properties.gate_length()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">gate</span> <span class="ow">in</span> <span class="n">basis_gates</span><span class="p">[:</span><span class="mi">4</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gate</span><span class="si">}</span><span class="s2"> gate : </span><span class="si">{</span><span class="n">props</span><span class="o">.</span><span class="n">gate_length</span><span class="p">(</span><span class="n">gate</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2"> sec&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id gate : 3.5555555555555554e-08 sec
rz gate : 0.0 sec
sx gate : 3.5555555555555554e-08 sec
x gate : 3.5555555555555554e-08 sec
</pre></div>
</div>
</div>
</div>
<p>Perhaps surprisingly we see that 3 of the 4 gates take the exact same amount of time, <span class="math notranslate nohighlight">\(35.6~\rm ns\)</span>, while the <code class="docutils literal notranslate"><span class="pre">rz</span></code> gates takes no time at all.  This is not a mistake.  The <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">sx</span></code> gates are set to be a specific duration of time, and the only parameter used for calibration is the gate amplitude.  For legacy reasons, an <code class="docutils literal notranslate"><span class="pre">id</span></code> gate on IBM hardware has its effective duration set to the same value.  In contrast, <code class="docutils literal notranslate"><span class="pre">rz</span></code> gates are virtual gates, the application of which is done in software; they modify the phase of later gates, but take no time themselves.  Although we have looked only at Q0, the <strong>single qubit timings are the same for any qubit in the system</strong>.</p>
<p>What about 2Q gates?  There is one 2Q gate per entry in the system <code class="docutils literal notranslate"><span class="pre">coupling_map</span></code>.  So we can use this map to iterate over all the 2Q gate values as well using <code class="docutils literal notranslate"><span class="pre">properties.gate_length()</span></code>.  However, in contrast to the 1Q data, here we will see that there is a spread of durations for the 2Q gates:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cx_durations</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">backend</span><span class="o">.</span><span class="n">configuration</span><span class="p">()</span><span class="o">.</span><span class="n">coupling_map</span><span class="p">:</span>
    <span class="n">cx_durations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">gate_length</span><span class="p">(</span><span class="s1">&#39;cx&#39;</span><span class="p">,</span> <span class="n">edge</span><span class="p">))</span>
    
<span class="n">mean_cx_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cx_durations</span><span class="p">)</span>
<span class="n">stddev_cx_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">cx_durations</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cx duration : </span><span class="si">{</span><span class="n">mean_cx_time</span><span class="si">}</span><span class="s2"> sec </span><span class="se">\u00B1</span><span class="s2"> </span><span class="si">{</span><span class="p">(</span><span class="n">stddev_cx_time</span><span class="o">/</span><span class="n">mean_cx_time</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cx duration : 4.1536507936507934e-07 sec ± 44.308526904800885 %
</pre></div>
</div>
</div>
</div>
<p>We see that there is a very wide spread of values of <code class="docutils literal notranslate"><span class="pre">cx</span></code> gates durations across the device.  Thus which qubits and therefore 2Q gates we use in a circuit will have a fairly large impact on the overall runtime.  Comparing the 1Q and 2Q gate times, we see that a 2Q gate on this system takes roughly 10x longer than a 1Q gate.</p>
<p>Lastly, let us now look to see how long measurements take.  This information is stored as <code class="docutils literal notranslate"><span class="pre">properties.readout_length()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">meas_durations</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">qubit</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">backend</span><span class="o">.</span><span class="n">configuration</span><span class="p">()</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">):</span>
    <span class="n">meas_durations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">readout_length</span><span class="p">(</span><span class="n">qubit</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Looking at the full list one can see that all the measurement durations are the same, and are roughly 2x longer than the typical <code class="docutils literal notranslate"><span class="pre">cx</span></code> gate times on this system.  Since all the values are the same, here we just show the zeroth entry:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">meas_durations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.755555555555555e-07
</pre></div>
</div>
</div>
</div>
<p>Note that older systems may have measurement durations that are much long than that shown here.</p>
</section>
<section id="scheduling-circuits">
<h2>Scheduling circuits<a class="headerlink" href="#scheduling-circuits" title="Permalink to this heading">#</a></h2>
<p>Now that we have taken a look at soem timing information from our backend, it is now time to add that information into our circuits.  In Qiskit, adding timing information is called “scheduling”, and wile it can be done a couple of ways, the easiest is using <code class="docutils literal notranslate"><span class="pre">transpile</span></code>.</p>
<p>Scheduling a circuit requires a backend with that information (no abstract simulators), and the type of scheduling is set via the <code class="docutils literal notranslate"><span class="pre">scheduling_method</span></code> keyword argument.  We can pass two strings to this arguement, <code class="docutils literal notranslate"><span class="pre">'alap'</span></code> for As-Late-As-Possible sheduling where all the gates are pushed as late as possible (farthest to the right) in the circuit.  Alternatively, <code class="docutils literal notranslate"><span class="pre">asap</span></code> scheduling moves everything to execute as early as possible (fartherst to the left).  <code class="docutils literal notranslate"><span class="pre">'alap'</span></code> is what the backends use by default.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sched_qc1</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">qc1</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">optimization_level</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">scheduling_method</span><span class="o">=</span><span class="s1">&#39;alap&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sched_qc1</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/bf18625d275139ddd1e352eb2be0368f6b2f40f722ef7172eb1bf1609b8cf96d.png" src="../../_images/bf18625d275139ddd1e352eb2be0368f6b2f40f722ef7172eb1bf1609b8cf96d.png" />
</div>
</div>
<p>We see that our now contains <code class="docutils literal notranslate"><span class="pre">delay</span></code> instructions.  In fact, there is at least one <code class="docutils literal notranslate"><span class="pre">delay</span></code> on each qubit, regardless of if it is actually active or not.  Each <code class="docutils literal notranslate"><span class="pre">delay</span></code> effective works as a “do nothing” object that has a specific duration.  This is different than an idenity gate with time because, unlike identity gates that can be combined and satisfy commutation relations, <code class="docutils literal notranslate"><span class="pre">delay</span></code> operations are fixed, and cnnot be removed or simplified.</p>
<p>The duration of <code class="docutils literal notranslate"><span class="pre">delay</span></code> instructions in the circuit above are in units of <code class="docutils literal notranslate"><span class="pre">dt</span></code>.  So what in the world is <code class="docutils literal notranslate"><span class="pre">dt</span></code>?  Unlike the continuous flow of time that we are familiar with, the timing information in a quantum circuit is discrete.  This discreteness is dtermined by the resolution of the waveform generators used to construct the pulse-shapes that correspond to the gates in a circuit.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">dt</span></code> value in the circuit corresponds to the granularity time corresponding to this resolution.  We can get a numerical value for <code class="docutils literal notranslate"><span class="pre">dt</span></code> from the backend’s configuration:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">configuration</span><span class="p">()</span><span class="o">.</span><span class="n">dt</span>
<span class="n">dt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.2222222222222221e-10
</pre></div>
</div>
</div>
</div>
<p>We can then multiply this value with the circuit’s <code class="docutils literal notranslate"><span class="pre">duration</span></code> that is in units of <code class="docutils literal notranslate"><span class="pre">dt</span></code> to get the runtime of the circuit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sched_qc1</span><span class="o">.</span><span class="n">duration</span> <span class="o">*</span> <span class="n">dt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.7564444444444444e-06
</pre></div>
</div>
</div>
</div>
<p>Here we see that the circuit takes about 1.7 microseconds to run.</p>
<p>We can get a better feel for the timing in this circuit by using the <code class="docutils literal notranslate"><span class="pre">timeline_drawer</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeline_drawer</span><span class="p">(</span><span class="n">sched_qc1</span><span class="p">,</span> <span class="n">show_idle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/64bc7f6d1ccc3bc37a79f7ef0ee3563a4efcd80f6c352682f5277c8be3b9b77f.png" src="../../_images/64bc7f6d1ccc3bc37a79f7ef0ee3563a4efcd80f6c352682f5277c8be3b9b77f.png" />
</div>
</div>
<p>From this view we get a better feel of how the operations in a circuit are laid out in time.  In particular notice that the qubits are not always busy.  Instead, there are portions of the circuit where one or more qubits are idle; waiting for operations on other qubits to be applied.  Qubits that are idle are still suceptible to noise, and it is actually beneficial to keep them active using particular gate sequences that approximately “decouple” the qubits from noise sources.  We will see how this works later on.</p>
<p>Let us now turn to the second circuit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sched_qc2</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">qc2</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">optimization_level</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
                      <span class="n">scheduling_method</span><span class="o">=</span><span class="s1">&#39;alap&#39;</span><span class="p">,</span> <span class="n">seed_transpiler</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeline_drawer</span><span class="p">(</span><span class="n">sched_qc2</span><span class="p">,</span> <span class="n">show_idle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5a4fb6f4a1938f1e3b5ecd878674e47f824e0a894c3e1d64a8cf76862952a32b.png" src="../../_images/5a4fb6f4a1938f1e3b5ecd878674e47f824e0a894c3e1d64a8cf76862952a32b.png" />
</div>
</div>
<p>Circuit #2 is obviously much longer than circuit #1 due to the increased number of <code class="docutils literal notranslate"><span class="pre">cx</span></code> gates in the circuit.  This is to be expected because, as we have seen earlier, a circuit requiring more than 3 <code class="docutils literal notranslate"><span class="pre">cx</span></code> gates on a single qubit needs to add <code class="docutils literal notranslate"><span class="pre">swap</span></code> gates.  In the case of the example above, there are 2 added <code class="docutils literal notranslate"><span class="pre">swap</span></code> gates.  Looking at the total execution time for this circuit it is about twice as much as the first:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sched_qc2</span><span class="o">.</span><span class="n">duration</span> <span class="o">*</span> <span class="n">dt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.509333333333333e-06
</pre></div>
</div>
</div>
</div>
</section>
<section id="rep-delay">
<h2>Rep delay<a class="headerlink" href="#rep-delay" title="Permalink to this heading">#</a></h2>
<p>When running circuits on hardware, the actual runtime per circuit execution is not just the raw time from the circuit, but also includes a repetition delay (<code class="docutils literal notranslate"><span class="pre">rep_delay</span></code>) time.  This time is inserted between circuits to allow for relaxation (<span class="math notranslate nohighlight">\(T_{1}\)</span>) to help prepare the ground state for the next execution.</p>
<p>On any IBM Quantum system, the default <code class="docutils literal notranslate"><span class="pre">rep_delay</span></code> used by the system is given by:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rep_delay</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">configuration</span><span class="p">()</span><span class="o">.</span><span class="n">default_rep_delay</span>
<span class="n">rep_delay</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9.999999999999998e-05
</pre></div>
</div>
</div>
</div>
<p>So the total time taken when executing circuit #2 above a single time is dominated by the <code class="docutils literal notranslate"><span class="pre">rep_delay</span></code> time, with a total wall clock time of:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sched_qc2</span><span class="o">.</span><span class="n">duration</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">+</span> <span class="n">rep_delay</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.00010350933333333331
</pre></div>
</div>
</div>
</div>
<p>So this result is saying that, in absence of any other overheads, we can execute about 10,000 circuits per second.  Note that the <code class="docutils literal notranslate"><span class="pre">rep_delay</span></code> is a parameter that is tunable by end users, and can be set between a range of values</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">backend</span><span class="o">.</span><span class="n">configuration</span><span class="p">()</span><span class="o">.</span><span class="n">rep_delay_range</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.0, 0.0005]
</pre></div>
</div>
</div>
</div>
<p>One can set this in <code class="docutils literal notranslate"><span class="pre">backend.run()</span></code>, e.g.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">circuits</span><span class="p">,</span> <span class="n">rep_delay</span><span class="o">=</span><span class="mf">300e-6</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="noisy-simulation-of-scheduled-circuits">
<h2>Noisy simulation of scheduled circuits<a class="headerlink" href="#noisy-simulation-of-scheduled-circuits" title="Permalink to this heading">#</a></h2>
<p>One of the important benefits of having timing information in our circuits is that it allows us to compute the errors associated with qubits being left idle.  Up until now, our noisy simulations only included errors associated with gates.  However, even when idle, qubits are subject to relaxation and dephasing due to the finite values of <span class="math notranslate nohighlight">\(T_{1}\)</span> and <span class="math notranslate nohighlight">\(T_{2}\)</span>, respectively.  Upon scheduling, a circuit now has one or more <code class="docutils literal notranslate"><span class="pre">delay</span></code> instructions with specific durations that allow a simulator to compute the effect of <span class="math notranslate nohighlight">\(T_{1}\)</span> and <span class="math notranslate nohighlight">\(T_{2}\)</span> over this time span.  Because these errors are in addition to those that come from gates, the overall fidelity predicted by the simulation will go down.  It will however better model the results that should be expected from exection on hardware.</p>
<section id="the-effect-of-t-1-and-t-2">
<h3>The effect of <span class="math notranslate nohighlight">\(T_{1}\)</span> and <span class="math notranslate nohighlight">\(T_{2}\)</span><a class="headerlink" href="#the-effect-of-t-1-and-t-2" title="Permalink to this heading">#</a></h3>
<p><span class="math notranslate nohighlight">\(T_{1}\)</span> and <span class="math notranslate nohighlight">\(T_{2}\)</span> correspond to time scales for relaxation and dephasing, respectively.  To see what that terminology means, let us consider two simple experiments.  First, let us flip a single qubit into the <span class="math notranslate nohighlight">\(|1\rangle\)</span> state, and then add a <code class="docutils literal notranslate"><span class="pre">delay</span></code> instruction parameterized by a time <span class="math notranslate nohighlight">\(\tau\)</span> before measuring.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tau</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;tau&#39;</span><span class="p">)</span>

<span class="n">flip_delay_qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">flip_delay_qc</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">flip_delay_qc</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">flip_delay_qc</span><span class="o">.</span><span class="n">measure_all</span><span class="p">()</span>
<span class="n">flip_delay_qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4dd79aa899ef5131c1b55fceae6f9fd917af2e8e8e6aa46040b458fd0151fd3c.png" src="../../_images/4dd79aa899ef5131c1b55fceae6f9fd917af2e8e8e6aa46040b458fd0151fd3c.png" />
</div>
</div>
<p>By default everything is in units of <code class="docutils literal notranslate"><span class="pre">dt</span></code>, so lets query the backend to find its <span class="math notranslate nohighlight">\(T_{1}\)</span> time and express it in terms of <code class="docutils literal notranslate"><span class="pre">dt</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t1_dt_duration</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">backend</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span><span class="o">.</span><span class="n">qubit_property</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;T1&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">backend</span><span class="o">.</span><span class="n">configuration</span><span class="p">()</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
<span class="n">t1_dt_duration</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>544694
</pre></div>
</div>
</div>
</div>
<p>Let us now seep the <code class="docutils literal notranslate"><span class="pre">delay</span></code> time <span class="math notranslate nohighlight">\(\tau\)</span> over several times the <span class="math notranslate nohighlight">\(T_{1}\)</span> duration and see what happens:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulate over 3x the T1 time, taking 50 steps</span>
<span class="n">t1_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">t1_dt_duration</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="c1"># Create a collection of circuits, one for each time in t1_times</span>
<span class="n">delay_circs</span> <span class="o">=</span> <span class="p">[</span><span class="n">flip_delay_qc</span><span class="o">.</span><span class="n">assign_parameters</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">dt</span><span class="p">)])</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">t1_times</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Execute the circuits and look at the probability of remaining in the <span class="math notranslate nohighlight">\(|1\rangle\)</span> state</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">shots</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">)</span>
<span class="n">flip_delay_counts</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">delay_circs</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The probability of being in the |1&gt; state at each time</span>
<span class="n">probs_up</span> <span class="o">=</span> <span class="p">[</span><span class="n">cnts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="n">shots</span> <span class="k">for</span> <span class="n">cnts</span> <span class="ow">in</span> <span class="n">flip_delay_counts</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t1_times</span><span class="p">,</span> <span class="n">probs_up</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">t1_dt_duration</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.4&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">t1_dt_duration</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="s2">&quot;$T_</span><span class="si">{1}</span><span class="s2">$ time&quot;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.4&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="s2">&quot;1/e&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probability&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (dt)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Probability of remaining in $|1</span><span class="se">\\</span><span class="s1">rangle$ state&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/308578afda3b70d611191e2bf2d372ea1db59505b71aa2d267e6eb8f48cdd9d4.png" src="../../_images/308578afda3b70d611191e2bf2d372ea1db59505b71aa2d267e6eb8f48cdd9d4.png" />
</div>
</div>
<p>we see that, at he <span class="math notranslate nohighlight">\(T_{1}\)</span> time, the probsbility of remaining in the <span class="math notranslate nohighlight">\(|1\rangle\)</span> state is <span class="math notranslate nohighlight">\(1/e\)</span> of its original value.  This can de taken at the definition of the <span class="math notranslate nohighlight">\(T_{1}\)</span> time; it is a measure of how fast a system relaxes back to the ground state.</p>
<p>We can do a similar study to find out what <span class="math notranslate nohighlight">\(T_{2}\)</span> is doing.  To do so we start with the qubit in the <span class="math notranslate nohighlight">\(|0\rangle\)</span> state, and apply an <code class="docutils literal notranslate"><span class="pre">H</span></code> gate to bring it to the <span class="math notranslate nohighlight">\(|+\rangle\)</span> state, and then wait.  After some time <span class="math notranslate nohighlight">\(\tau\)</span> we apply another <code class="docutils literal notranslate"><span class="pre">H</span></code>, and see what the probability is to find the qubit back in the ground state.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diff_delay_qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">diff_delay_qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">diff_delay_qc</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">diff_delay_qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">diff_delay_qc</span><span class="o">.</span><span class="n">measure_all</span><span class="p">()</span>
<span class="n">diff_delay_qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9ce9989885578ff044be2ee508d9272f572bafdc55564a6998b05fbf1b1e3086.png" src="../../_images/9ce9989885578ff044be2ee508d9272f572bafdc55564a6998b05fbf1b1e3086.png" />
</div>
</div>
<p><img alt="M3" src="../../_images/diffusion2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2_dt_duration</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">backend</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span><span class="o">.</span><span class="n">qubit_property</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;T2&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">backend</span><span class="o">.</span><span class="n">configuration</span><span class="p">()</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">t2_dt_duration</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">diff_circs</span> <span class="o">=</span> <span class="p">[</span><span class="n">diff_delay_qc</span><span class="o">.</span><span class="n">assign_parameters</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">dt</span><span class="p">)])</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">t2_times</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trans_diff</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">diff_circs</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">scheduling_method</span><span class="o">=</span><span class="s1">&#39;alap&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diff_delay_counts</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">trans_diff</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mf">1e4</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">probs_down</span> <span class="o">=</span> <span class="p">[</span><span class="n">cnts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="mf">1e4</span> <span class="k">for</span> <span class="n">cnts</span> <span class="ow">in</span> <span class="n">diff_delay_counts</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t2_times</span><span class="p">,</span> <span class="n">probs_down</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.5</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">e</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.4&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">e</span><span class="o">+</span><span class="mf">0.51</span><span class="p">,</span> <span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">frac</span><span class="si">{1}{2e}</span><span class="s2">+</span><span class="se">\\</span><span class="s2">frac</span><span class="si">{1}{2}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">t2_dt_duration</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.4&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">t2_dt_duration</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="s2">&quot;$T_</span><span class="si">{2}</span><span class="s2">$ time&quot;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probability&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (dt)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Probability of going back to $|0</span><span class="se">\\</span><span class="s1">rangle$ state&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/60d644b81f61936fd7728b5a3fd4bdc11a7b8938036f1fc42d4e1e7687cf136a.png" src="../../_images/60d644b81f61936fd7728b5a3fd4bdc11a7b8938036f1fc42d4e1e7687cf136a.png" />
</div>
</div>
</section>
<section id="noisy-simulation-with-and-without-timing">
<h3>Noisy simulation with and without timing<a class="headerlink" href="#noisy-simulation-with-and-without-timing" title="Permalink to this heading">#</a></h3>
<p>Knowing what happens when qubits are left idle, let us now return to our 5Q GHZ circuits and look at the resulting fidelity both with and without scheduling.  Here we will only look at <code class="docutils literal notranslate"><span class="pre">qc2</span></code>, and transpile it without scheduling:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trans_qc2</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">qc2</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">optimization_level</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">seed_transpiler</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can now compare the outputs with and without scheduling against the known ideal answer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ideal_ans</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="mi">5</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="o">*</span><span class="mi">5</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>using the fidelity.  Let us get the counts:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Counts from scheduled circuit</span>
<span class="n">sched_counts</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">sched_qc2</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mf">1e4</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>
<span class="c1"># Counts from circuit without timing</span>
<span class="n">trans_counts</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">trans_qc2</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mf">1e4</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The fidelity without timing information is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hellinger_fidelity</span><span class="p">(</span><span class="n">trans_counts</span><span class="p">,</span> <span class="n">ideal_ans</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9326215674976868
</pre></div>
</div>
</div>
</div>
<p>whereas including timing information, and the noise associated with qubit idle times, yields:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hellinger_fidelity</span><span class="p">(</span><span class="n">sched_counts</span><span class="p">,</span> <span class="n">ideal_ans</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9176072268887857
</pre></div>
</div>
</div>
</div>
<p>We see that the fidelity is reduced for a scheduled circuit.  This is expected as we are including more sources of noise in our simulations.  This noise is always there on real hardware, so the results from scheduled circuits are more faithful representations of what to expect when running on quantum systems.</p>
</section>
</section>
<section id="hands-on-example">
<h2>Hands-on example<a class="headerlink" href="#hands-on-example" title="Permalink to this heading">#</a></h2>
<p>Up until now we have played with simulators and small problems.  Let us now try to work with real hardware.</p>
<p>Consider the following 12-qubit circuit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="n">qc</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>

<span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">ch</span><span class="p">(</span><span class="n">kk</span><span class="p">,</span> <span class="n">kk</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">ch</span><span class="p">(</span><span class="n">kk</span><span class="p">,</span> <span class="n">kk</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5e423c340ce1385b8cbcf3add05d9857a18acc511f35e99414c7f844c69f903a.png" src="../../_images/5e423c340ce1385b8cbcf3add05d9857a18acc511f35e99414c7f844c69f903a.png" />
</div>
</div>
<p>where we wish to compute the expectation value of the operator <span class="math notranslate nohighlight">\(\langle Z_{n-1}\cdots Z_{1}Z_{0}\rangle\)</span> on a real device.</p>
<p>There is a general receipe to follow when working on problems that are small enough to be classically simulated.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1. If not known, find the ideal answer

2. Compile the circuit for a target device

3. Perform a noisy simulation (here both regular and scheduled)

4. Run the circuit on target device and get results 
</pre></div>
</div>
<p>Here lets try to do the above steps for the circuit and operator above.  In addition, find the total amount of time of circuit execution time, including <code class="docutils literal notranslate"><span class="pre">rep_delay</span></code> and compare to the reported total time of the job on the IBM Quantum website.</p>
<section id="tips">
<h3>Tips<a class="headerlink" href="#tips" title="Permalink to this heading">#</a></h3>
<p>It is possible to get the statevector resulting from action of a quantum circuit <strong>with no measurements</strong> using</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="kn">from</span> <span class="nn">qiskit.quantum_info</span> <span class="kn">import</span> <span class="n">Statevector</span>
<span class="n">Statevector</span><span class="o">.</span><span class="n">from_instruction</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
<p>the ideal distribution of counts can be obtained via the state vectors <code class="docutils literal notranslate"><span class="pre">probabilities_dict()</span></code> method.</p>
<p>We cannot use the fake backend simulators here because they do not represent the current noise in the system; they are snapshots of a device at some time in the past.  To generate a simulator that models the current hardware noise one can do:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="kn">from</span> <span class="nn">qiskit_aer</span> <span class="kn">import</span> <span class="n">AerSimulator</span>

<span class="n">backend_sim</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="o">.</span><span class="n">from_backend</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">backend</span></code> is the IBM Quantum system that you want to use.</p>
</section>
<section id="compute-ideal-answer">
<h3>Compute ideal answer<a class="headerlink" href="#compute-ideal-answer" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">state_vec</span> <span class="o">=</span> <span class="n">Statevector</span><span class="o">.</span><span class="n">from_instruction</span><span class="p">(</span><span class="n">qc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ideal_probs</span> <span class="o">=</span> <span class="n">state_vec</span><span class="o">.</span><span class="n">probabilities_dict</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sampled_expectation_value</span><span class="p">(</span><span class="n">ideal_probs</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.44628906249999983
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-real-device-and-simulator-model">
<h3>Load real device and simulator model<a class="headerlink" href="#load-real-device-and-simulator-model" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IBMQ</span><span class="o">.</span><span class="n">load_account</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AccountProvider for IBMQ(hub=&#39;ibm-q&#39;, group=&#39;open&#39;, project=&#39;main&#39;)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">provider</span> <span class="o">=</span> <span class="n">IBMQ</span><span class="o">.</span><span class="n">get_provider</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="s1">&#39;internal-test&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">backend</span> <span class="o">=</span> <span class="n">provider</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;ibm_hanoi&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">backend_sim</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="o">.</span><span class="n">from_backend</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="compute-simulated-answer-with-no-timing">
<h3>Compute simulated answer with no timing<a class="headerlink" href="#compute-simulated-answer-with-no-timing" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trans_qc</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">qc</span><span class="o">.</span><span class="n">measure_all</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">backend</span><span class="p">,</span> <span class="n">optimization_level</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                     <span class="n">seed_transpiler</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim_counts</span> <span class="o">=</span> <span class="n">backend_sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">trans_qc</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">))</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sampled_expectation_value</span><span class="p">(</span><span class="n">sim_counts</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.2486
</pre></div>
</div>
</div>
</div>
</section>
<section id="schedule-and-simulate">
<h3>Schedule and simulate<a class="headerlink" href="#schedule-and-simulate" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sched_qc</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">qc</span><span class="o">.</span><span class="n">measure_all</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">backend</span><span class="p">,</span> <span class="n">optimization_level</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                     <span class="n">seed_transpiler</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span> <span class="n">scheduling_method</span><span class="o">=</span><span class="s1">&#39;alap&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeline_drawer</span><span class="p">(</span><span class="n">sched_qc</span><span class="p">,</span> <span class="n">show_idle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6df370b6223136b85f6e8500380bc9a06077e05d60ef274b284b67e8dca9d3a1.png" src="../../_images/6df370b6223136b85f6e8500380bc9a06077e05d60ef274b284b67e8dca9d3a1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sched_counts</span> <span class="o">=</span> <span class="n">backend_sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">sched_qc</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">))</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sampled_expectation_value</span><span class="p">(</span><span class="n">sched_counts</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.215
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rep_delay</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">configuration</span><span class="p">()</span><span class="o">.</span><span class="n">default_rep_delay</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">configuration</span><span class="p">()</span><span class="o">.</span><span class="n">dt</span>
<span class="n">circuit_duration</span> <span class="o">=</span> <span class="n">sched_qc</span><span class="o">.</span><span class="n">duration</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_per_shot</span> <span class="o">=</span> <span class="n">circuit_duration</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="n">rep_delay</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total raw circuit execution time: </span><span class="si">{}</span><span class="s1"> sec&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time_per_shot</span> <span class="o">*</span> <span class="mf">1e4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total raw circuit execution time: 2.5314666666666668 sec
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">real_job</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">trans_qc</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">real_counts</span> <span class="o">=</span> <span class="n">real_job</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sampled_expectation_value</span><span class="p">(</span><span class="n">real_counts</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.168
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Real execution time: &quot;</span><span class="p">,</span> <span class="n">real_job</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">time_taken</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Real execution time:  8.26334547996521
</pre></div>
</div>
</div>
</div>
<p>We see that the real execution time is longer than the raw circuit time.  This is because there are classical overheads, such as converting an input circuit to waveforms, that also take time.</p>
</section>
</section>
</section>

<div class="section ablog__blog_comments">
  
  
</div>

                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../compiling/compiling.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Using the Qiskit compiler</p>
      </div>
    </a>
    <a class="right-next"
       href="dynamical-decoupling.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Dynamical decoupling</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#frontmatter">Frontmatter</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#circuit-timing">Circuit timing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#backend-timing-information">Backend timing information</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scheduling-circuits">Scheduling circuits</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rep-delay">Rep delay</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#noisy-simulation-of-scheduled-circuits">Noisy simulation of scheduled circuits</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-effect-of-t-1-and-t-2">The effect of <span class="math notranslate nohighlight">\(T_{1}\)</span> and <span class="math notranslate nohighlight">\(T_{2}\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#noisy-simulation-with-and-without-timing">Noisy simulation with and without timing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hands-on-example">Hands-on example</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tips">Tips</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-ideal-answer">Compute ideal answer</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-real-device-and-simulator-model">Load real device and simulator model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-simulated-answer-with-no-timing">Compute simulated answer with no timing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#schedule-and-simulate">Schedule and simulate</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../../_sources/how-to/timing/circuit-timing.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

<footer class="bd-footer">
<div>
<p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/">
        Content on
        <a property="dct:title" rel="cc:attributionURL" href="http://quantum-enablement.org">this website</a> 
        by <span property="cc:attributionName">IBM</span> is licensed under 
        <a href="http://creativecommons.org/licenses/by-nc/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">
                Attribution-NonCommercial 4.0 International<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1">
                <img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1">
                <img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1">
        </a>
</p> 
</div>
</footer>

  </body>
</html>